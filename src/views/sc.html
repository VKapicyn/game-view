{% extends "templates/page.html" %}
        <!-- Для шапки и футера однозначно нужен темплейт -->
{% block content %}
<div class="row">
    <div class="col-lg-12 col-sm-12">
        <h3>Контракт #{{sc._id}}</h3>
        <p>Баланс: {{sc.resBalance}}</p>
        <p>Автор: {{sc.author}}</p>
        <p>Результаты:<br>
            {% for res in sc.results %}
                {% if res.user %}
                <b>{{res.user}}</b> = {{res.balance}} y.e.<br>
                {% else %}
                <i><span>Недостаточно данных...</span><br></i>
                {% endif %}
            {% endfor %}
        </p>
    </div>
</div>
<hr>
<div class="row">
    <div class="col-lg-4 col-sm-12">
        <button class="btn btn-block btn-info" data-toggle="collapse" data-target="#collapseExample">
            Код
        </button> 
    </div>
    <div class="col-lg-4 col-sm-12">
        <a class="btn btn-block btn-default" href="/sc/distribute/{{sc._id}}">
            Распределить баланс
        </a>
    </div>
    <div class="col-lg-4 col-sm-12">
        <a class="btn btn-block btn-default" href="/wallet/{{sc._id}}" target="_blank">
            Пополнить
        </a> 
    </div>
</div>
<div class="row">
    <div class="col-lg-12 col-sm-12">
        <div class="collapse" id="collapseExample">
            <div class="card card-body" style="margin-top:20px;">
                {{sc.text | striptags(true) | escape | nl2br }}
            </div>
        </div>
    </div>
</div>
<hr>

    {% for field in sc.fields %}
    <div class="row">
            <div class="col-1 col-sm-1 col-md-1 col-lg-1">
                <span>{{field.name}}</span>
            </div>

        <div class="col-lg-6 sol-sm-12">
        {% if field.author %}
            <p><b>{{field.value}}</b> [<i>Заполнил: {{field.author}}</i>]</p>
        {% else %}
            <form action="/sc/field" method="POST">
                {% if (field.type=="$слово") or (field.type=="$буква") or (field.type=="$число") %}
                    <div class="col-7 col-sm-7 col-md-7 col-lg-7">
                        <input name="data" type="text" class="form-control"  placeholder="{{field.type}}" />
                    </div>
                {% endif %}

                {% if field.type=="$время" %}
                    <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                {% else %}
                    <div class="col-5 col-sm-5 col-md-5 col-lg-5">
                {% endif %}
                <input name="fieldId" type="hidden" value="{{field._id}}" />
                <input name="fieldName" type="hidden" value="{{field.name}}" />
                <input name="skId" type="hidden" value="{{sc._id}}" />
                <button class="btn btn-success btn-block">&#10004;</button>
                </div>
            </form>
            <div class="col-12" style="position: static !important;">
                &nbsp;&nbsp;&nbsp;&nbsp;<i>доступен ввод для {{field.sec}}</i>
            </div>
            
            {% endif %}
        </div>
    </div>
    {% endfor %}
<hr>
<div class="row">
    <div class="col-lg-12 col-sm-12">
        <h3>Операции с контрактом #{{sc._id}}</h3>
        <div class="table-responsive overflow-auto">
            <table class="table">
              <thead style="text-align: center;">
                <tr>
                  <th >#</th>
                  <th>Время</th>
                  <th>Раунд</th>
                  <th>Актор</th>
                  <th>Действие</th>
                </tr>
              </thead>
              <tbody id="logs-div">
                {% for log in logs %}
                <tr>
                    <th scope="row">{{loop.index}}</th>
                    <td>{{log.time}}</td>
                    <td>{{log.round}}</td>
                    <td>{{log.author}}</td>
                    <td>{{log.data}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
    </div>
</div>        
{% endblock %}